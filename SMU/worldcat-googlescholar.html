<div class="EXLFacetContainer">
  <h3>Didn't find what you were looking for?</h3>
  <ol class="EXLFacetsList EXLFacetsListPreview">
    <li class="EXLFacet">
      <span id="worldcat-label">For Books try</span>
      <a id="worldcat-link" target="_blank" href="https://smu.on.worldcat.org/search">WorldCat</a>
    </li>
    <li class="EXLFacet">
      <span id="googlescholar-label">For Articles try</span>
      <a id="googlescholar-link" target="_blank" href="https://scholar.google.com/scholar">Google Scholar</a>
    </li>
  </ol>
</div>

<script type="text/javascript">
// <[![CDATA

//The links in the static HTML above are just links out to WorldCat and Google.
//If the end user has javascript blocked, those will work as they are (I don't think anything else in Primo will, though.)
//This script adds extra functionality to the links.

var novanet = novanet || {};
if (!novanet.uri){
  novanet.uri = new URI();
}
if (!novanet.params){
  novanet.params = novanet.uri.search(true);
}

$(document).ready(function(){
  var query = (novanet.params.query && novanet.params.query.split(',',3)[2]) || '',
      t0 = novanet.params['vl(freeText0)'] || '',
      t1 = novanet.params['vl(freeText1)'] || '',
      t2 = novanet.params['vl(freeText2)'] || '',
      freeText = t0 + ' ' + t1 + ' ' + t2;
      
  query = query.replace(/\s+/g, ' ').replace(/^\s|\s$/g, '');
  freeText = freeText.replace(/\s+/g, ' ').replace(/^\s|\s$/g, '');
  query = query || freeText;
  
  if (!query){
    //no search terms supplied.  Don't do anything.
    return;
  }

  //console.log('query: "' + query + '"');
  //set the rest of the variables we'll need.
  var lang = $('body').hasClass('EXLCurrentLang_fr_FR') ? 'fr' : 'en',
      $wlink = $('#worldcat-link'),
      wlink = new URI($wlink.attr('href')),
      $glink = $('#googlescholar-link'),
      glink = new URI($glink.attr('href'));
      
  //modify the local URI object:
  glink.addQuery('hl', lang);
  glink.addQuery('q', query);

  //update the DOM node with the new href:
  $glink.attr('href', glink.toString());
  
  //modify the local URI object:
  // N.B. There's all kinds of Advanced Search stuff we can do here that is currently omitted.
  wlink.addQuery('queryString', query);
  
  //update the DOM node with the new href:
  $wlink.attr('href', wlink.toString());
  
});

// ]]>
</script>
